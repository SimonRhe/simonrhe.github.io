<!DOCTYPE html> 
<html lang="en"> 
<head> 
  <meta charset="utf-8"> 
  <meta name="viewport" content="width=device-width, initial-scale=1" /> 
  <title>Automating the deployment of your local Eleventy site to GitHub user pages</title> 
  <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Noto+Sans+JP:wght@500&family=Roboto:wght@300&display=swap"> 
  <link rel="stylesheet" href="/css/site.css">
</head> 
<body> 

    <div class="post-grid">

<p><a href="/">‚Üê Back to home page</a></p>

<h1>Automating the deployment of your local Eleventy site to GitHub user pages</h1>

<!-- Excerpt Start -->
<p>To keep things simple and avoid costs, I decided to host my blog on <a href="https://help.github.com/en/github/working-with-github-pages/about-github-pages">GitHub‚Äôs user pages</a>, where you can publish a static site for free hosted at <code>&lt;your-username&gt;.github.io</code> or on your own custom domain. I needed a way to automate the deployment of the site so that publishing a new blog article would only require minimal work.</p>
<p>This post will show you how to set up your GitHub user page and automate the deployment of your locally generated Eleventy site using NPM scripts.</p>
<!-- Excerpt End -->
<p><img class="emoji" draggable="false" alt="üìã" src="https://twemoji.maxcdn.com/v/13.0.0/72x72/1f4cb.png"/> Required:</p>
<ul>
<li>Eleventy static site generator installed locally</li>
<li>Local installation of Git set up to work with your GibHub account</li>
</ul>
<h2>Setting up your GitHub user page</h2>
<p>Setting up your GitHub user page is very simple:</p>
<ul>
<li>Create a new public repository on your GitHub account called <code>&lt;your-username&gt;.github.io</code></li>
<li>Go to the repository‚Äôs Settings ‚Üí Git Hub Pages section and check that the following message is displayed: ‚ÄúYour site is published at <code>&lt;your-username&gt;.github.io</code>‚Äù.</li>
<li>That‚Äôs it! All files in your repository‚Äôs master branch are now served to the web. (Note that there can be some delay after creating or updating files before the changes are reflected)</li>
</ul>
<h2>Automating the upload process from your local environment</h2>
<p>The simplest way to publish your Eleventy-generated blog to GitHub pages is to build it locally, then upload it to the master branch of your user page repository.</p>
<p>This can be automated using NPM scripts.</p>
<p>As an example, my local setup has two sibling folders:</p>
<ul>
<li><strong><code>/myblog</code></strong> Blog development folder which contains the Markdown source files, all Eleventy-related dependencies and the <code>_site</code> folder generated by Eleventy</li>
<li><strong><code>/simonrhe.github.io</code></strong> Local clone of my GitHub user page repository</li>
</ul>
<p>You will need a <strong>local clone</strong> of your GitHub user page repository. To create this local copy:</p>
<ul>
<li>Go to your repository‚Äôs main page on GitHub</li>
<li>Click the green Clone button and copy the URL for your repository</li>
<li>On your local machine, go to the parent directory of your blog project folder</li>
<li>Run <code>git clone &lt;your-repository-URL&gt;</code></li>
</ul>
<p>This will create a new folder containing a local copy of your site, which you will be able to update locally before publishing.</p>
<p>Before being published, your site needs to be built by Eleventy. This is usually done using the <code>npm run build</code> command, and the resulting HTML files are saved in the project‚Äôs <code>_site</code> folder.</p>
<p><img class="emoji" draggable="false" alt="üí°" src="https://twemoji.maxcdn.com/v/13.0.0/72x72/1f4a1.png"/> <strong>Tip:</strong> Eleventy does not automatically delete unused files in the <code>_site</code> folder, so if you remove a Markdown page in your source, the HTML file generated by Eleventy in the <code>_site</code> folder during previous builds will not automatically be deleted. It is therefore a good idea to update the build script in your <code>package.json</code> file to completely delete the <code>_site</code> folder before each build. Unless you plan to work on the website with other users who are not on the same operating system as you, you can use your operating system‚Äôs remove command:</p>
<pre><code>    &quot;scripts&quot;: {
      &quot;build&quot;: &quot;@powershell rm -Recurse ./_site &amp;&amp; npx @11/eleventy&quot;
    }
</code></pre>
<p>Also in <code>package.json</code>, you can create scripts to automate the copying of files to be published to the web to the local clone of your GitHub repository and upload them to GitHub. I created two scripts: <code>replace</code> and <code>gitcommit</code>, and a third script that calls these two scripts, <code>upload</code>:</p>
<pre><code>  &quot;scripts&quot;: {
    &quot;replace&quot;: &quot;@powershell rm -Recurse ../simonrhe.github.io/* &amp;&amp; @powershell cp -Recurse ./_site/* ../simonrhe.github.io/&quot;, /* note that although all old files are deleted and replaced, Git detects whether the content of the file changed and will only commit files that have changed since the last commit */
    &quot;gitcommit&quot;: &quot;cd ../simonrhe.github.io &amp;&amp; git add -A &amp;&amp; git commit -m \&quot;Automatic update\&quot; &amp;&amp; git push&quot;, /* git add -A detects all updated, new and deleted files */
    &quot;upload&quot;: &quot;npm run replace &amp;&amp; npm run gitcommit&quot;
  }
</code></pre>
<p>Now, I can create a new Markdown file for a new blog post, and when I‚Äôm ready, I can build locally by running: <code>npm run build</code> (or use <code>npm run serve</code>, which automatically builds the site whenever a file is saved). When I‚Äôm happy with the resulting HTML pages generated by Eleventy in the <code>_site</code> folder, I can automatically publish them by running: <code>npm run upload</code>.</p>
<p><img class="emoji" draggable="false" alt="‚ö†Ô∏è" src="https://twemoji.maxcdn.com/v/13.0.0/72x72/26a0.png"/> <strong>Note:</strong> In addition to user pages, GitHub Pages also allows the creation of project-specific pages, for example to host the documentation about a project. These pages can be set up in the repository‚Äôs  Settings ‚Üí GitHub Pages section and are then available at <code>&lt;your-username&gt;.github.io/&lt;repository&gt;</code>. Project pages work differently than user pages as their source can also be located in the repository‚Äôs <code>/docs</code> folder or a different branch of the repository. The <a href="https://www.npmjs.com/package/gh-pages">gh-pages package</a> can help you automate deployment in this situation.</p>


</div>

</body> 
</html>